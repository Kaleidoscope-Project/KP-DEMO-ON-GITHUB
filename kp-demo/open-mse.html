<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QDS MSE App</title>
    <link rel="shortcut icon" type="image/png" href="../common/images/mcln-logo.png">

    <!-- Step 1: Add the CheerpJ runtime loader script -->
    <script src="https://cjrtnc.leaningtech.com/4.2/loader.js"></script>

    <style>
        body {
            margin: 0; /* Remove default body margin for a true full-page background */
            padding: 0;
            display: flex;
            justify-content: center; /* Horizontally centers the app */
            align-items: center; /* Vertically centers the app */
            min-height: 100vh; /* Ensures the body takes up the full viewport height */
            background-image: url("../common/images/line-bg-1-3.png"); /*  background-color: lightblue;*/
        }

        .centered-div {
            background-color: lightgreen;
            padding: 2px;
        }

        /* Add CSS to give your container a size and style border: 2px solid black;*/
        #swing-app-container {
          width: 1400px;
          height: 800px;
          /* Optional: style the container for the CheerpJ app */
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          border: 1px solid black; /* Example styling */
        }
    </style>
</head>

<body>
<!-- Step 2: Define the div for your Swing app class="centered-div"-->
<div id="swing-app-container"></div>

<!-- Step 3: Add the CheerpJ initialization script -->
<script>
    
    // Reload App function
     async function Java_dsdsse_app_MseAppAgent_reloadMSEAPP(lib, str) {
        console.log("Received input from Java: " + str);
     //   window.alert(str);
     //   await cheerpjRunJar("/app/KP-DEMO-ON-GITHUB/kp-demo/DQDS.MSE.jar");
    }
    
    async function Java_dsdsse_app_MseAppAgent_nativeSetApplication(lib, myApplication) {
        window.myApplication = myApplication;
        console.log(window.myApplication);
        console.log(myApplication);
        console.log("setting application");

        // Make the inputDiv visible after initialization
      //  document.getElementById('inputDiv').style.display = 'block';

        /* This makes the function 'never' return */
        return new Promise(() => { });
    }

    (async function() {
    
        // Get a reference to your div element
        const containerElement = document.getElementById("swing-app-container");
        
        // Initialize CheerpJ and pass the container element to create the display
        await cheerpjInit(
            {
                version: 17,
                natives: {
                    Java_dsdsse_app_MseAppAgent_reloadMSEAPP,
                    Java_dsdsse_app_MseAppAgent_nativeSetApplication
                }
            }
        );
        
        
        await cheerpjInit({ version: 17 }, { natives: {Java_dsdsse_app_DSDSSEApp_reloadMSEAPP }});
        
        cheerpjCreateDisplay(-1, -1, containerElement);
        
        // Run your JAR file
        // Starting from hp-demo directory as
        await cheerpjRunJar("/app/KP-DEMO-ON-GITHUB/kp-demo/DQDS.MSE.jar");
    })();
    
    async function sendHTMLRequestToApp() {
        // Get the input text from the HTML input box
<!--        const inputText = document.getElementById("inputText").value;-->
        console.log("Sending htmlRequestToApp");

        // Call the Java method with the input text
        await window.myApplication.processHTMLRequestToApp("request");
        // const response = await window.myApplication.processHTMLRequestToApp("request");
    }
</script>

</body>
</html>